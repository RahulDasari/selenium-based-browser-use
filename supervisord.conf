[supervisord]
nodaemon=true
logfile=/dev/stdout
logfile_maxbytes=0
loglevel=debug

[program:xvfb]
priority=1
command=/usr/bin/Xvfb :99 -screen 0 1920x1080x24 -ac +extension RANDR
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
autorestart=true
startsecs=3

[program:fluxbox]
priority=2
command=/usr/bin/fluxbox
environment=DISPLAY=:99
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
autorestart=true
startretries=5
startsecs=2

[program:x11vnc]
priority=3
command=/usr/bin/x11vnc -display :99 -forever -shared -quiet -wait 5 -noxdamage -usepw -rfbport 5900
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
autorestart=true
startretries=5
startsecs=2

[program:novnc]
priority=4
; wait for the VNC server to accept connections, then run novnc proxy
command=/usr/local/bin/wait-for-vnc.sh 127.0.0.1 5900 30 /usr/local/bin/novnc_proxy --vnc localhost:5900 --listen 0.0.0.0:8080
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
autorestart=true
startretries=5
startsecs=2

[program:selenium]
priority=5
command=python browser/main.py
environment=DISPLAY=:99
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
autorestart=false